<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>
  <body>

      "ModbusPal" is actually an instance of the ModbusPalProject java class.
"mbp_script_directory"

      14	Startup and on-demand scripts
14.1	Overview
Startup scripts and on-demand scripts are a bit different from scripted generators and bindings.
While scripted generators and bindings are only class definitions, startup scripts and on-demand scripts are procedures.
Startup scripts are executed automatically when the project is opened. They can be used to initialize the project (creating a custom GUI, for example).
On-demand scripts can be executed as often as desired, but each time they have to be triggered by the user.
14.2	Startup scripts
14.2.1	Adding startup scripts
Startup scripts are added by using the Script manager. Click on the “Script” button located in the main window to summon the Script manager’s window.

Click on the “Script” button in the main window in order to display the Script manager.
Then, in the Script manager window, select the “Startup scripts” tab and click on the “Add” button.

Click on the “Add” button in the “Startup scripts” tab in order to add a new startup script.
A file chooser dialog appears. Select a script file from your computer and validate. If the script file is valid, it is added in the list.

If the script file is valid, it is added in the list of startup scripts.
14.2.2	Execution of startup scripts
Startup scripts are executed automatically when the project file is loaded.
But they also can be executed later by clicking on the corresponding “Execute” button in the Script manager.

Click in the “Execute” button if you want to execute the startup script again.
14.2.3	Removing a startup script
A startup script can be removed from the project by clicking on the corresponding “Delete” button in the Script manager.

Click in the “Delete” button to delete the corresponding startup script.
14.2.4	Example
The following example is a startup script that displays a small dialog saying “Hello world”. It contains an “OK” button, which hides the window when clicked. If this script is added in the project as a startup script, then this dialog will appear each time the project file is loaded.

Content of “HelloWorldStartup.py”

from javax.swing import *
from java.awt import *

class HelloWorldFrame(JFrame):

  def buttonPushed(self,event):

    self.setVisible(False);

  def __init__(self):

    self.setTitle("Hello world");
    self.setSize(300, 100);
    self.setLayout(BorderLayout());
    self.setDefaultCloseOperation(WindowConstants.DISPOSE_ON_CLOSE);

    # create the Label
    self.label = JLabel('Hello, world !');
    self.add(self.label, BorderLayout.CENTER);

    # create the button
    self.button = JButton('OK',actionPerformed=self.buttonPushed);
    self.add(self.button, BorderLayout.SOUTH);



# Create the Hello world frame:
frame = HelloWorldFrame();

# Make it visible:
frame.setVisible(True);

# Make it the top window:
frame.toFront();


14.3	On-demand scripts
14.3.1	Adding on-demand scripts
On-demand scripts are added by using the Script manager. Click on the “Script” button located in the main window to summon the Script manager’s window.

Click on the “Script” button in the main window to display the Script manager.
Then, in the Script manager window, select the “On-demand scripts” tab and click on the “Add” button.

Click on the “Add” button in the “On-demand scripts” tab to add a new on-demand script.
A file chooser dialog appears. Select a script file from your computer and validate. If the script file is valid, it is added in the list.

If the script file is valid, it is added in the list of on-demand scripts.
14.3.2	Execution of on-demand scripts
On-demand scripts are only executed if triggered by clicking on the corresponding “Execute” button.

Click on the “Execute” button to execute the on-demand script.
14.3.3	Removing an on-demand script
An on-demand script can be removed from the project by clicking on the corresponding “Delete” button in the Script manager.

Click in the “Delete” button to delete the corresponding on-demand script.
14.3.4	Example
The following example is an on-demand script that disables all MODBUS slaves defined in the current project.

Content of “DisableAllSlavesOnDemand.py”

from modbuspal.main import ModbusPal
from modbuspal.main import ModbusConst

# Try each possible MODBUS slave addresses
for addr in range(ModbusConst.FIRST_MODBUS_SLAVE, ModbusConst.LAST_MODBUS_SLAVE+1):

  # Get the MODBUS slave object corresponding to this address
  slave = ModbusPal.getModbusSlave(addr);

  # Verify that there actually IS a MODBUS slave with this address
  if not(slave is None):

    # Disable the slave:
    slave.setEnabled(False);


 


  </body>
</html>
